<!DOCTYPE html>
<html>
  <head>
    <link href="main.css" rel="stylesheet" type="text/css">
    <script>
      // Get Request to DB
      function ajxGetRequest(){
        // Async Request object
        var xhttp = new XMLHttpRequest();
        console.log("button click works");
        // Call to endpoint
        xhttp.open("GET", "/manifest", true);
        // When Async Request is done do this callback function
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            // Parse JSON into a string
            var x = JSON.parse(this.responseText); 

            var table = document.createElement("table");
            var columnCount = 4;
            var row = table.insertRow(-1);
            for (var i = 0; i < columnCount; i++){
              var headerCell = document.createElement("TH");
              if (i = 0) {headerCell.innerHTML = "Order Number"};
              if (i = 1) {headerCell.innerHTML = "Customer Name"};
              if (i = 2) {headerCell.innerHTML = "Starting Location"};
              if (i = 3) {headerCell.innerHTML = "Ending Location"};
              row.appendChild(headerCell);
            }

            for (var i = 1; i < x.length; i++) {
              row = table.insertRow(-1);
              for (var j = 0; j < columnCount; j++) {
                var cell = row.insertCell(-1);
                cell.innerHTML = x[i][j];
              }
            }

            var dvTable = document.getElementById("testing");
            dvTable.innerHTML = "";
            dvTable.appendChild(table);


            // Start the string
            /*var str = "<br><table id=\"customers\"><tr><th>Order Number</th><th>Customer Name</th><th>Starting Location</th><th>Ending Location</th></tr>";
            for(var i = 0; i <x.length; i++) {
              // Create the List Items in the middle of the string
              str += "<tr><td> " + x[i].id + "</td><td>" + x[i].name + "</td><td>" + x[i].startloc + "</td><td>" + x[i].endloc + "</td></tr>";
            }
            // End the ul
            str += "</table>";
            // set element "testing" to the str variable made earlier
            document.getElementById("testing").innerHTML = str;
          }*/
        }
      }
        // Send it all off
        xhttp.send();
      }

      function storeValues(){
        var inputName = document.getElementById("customerName");
        var inputStartLocation = document.getElementById("startLocation");
        var inputEndLocation = document.getElementById("endLocation");
        sessionStorage.setItem("customerName", inputName.value);
        sessionStorage.setItem("startLocation", inputStartLocation.value);
        sessionStorage.setItem("endLocation", inputEndLocation.value);
      }
    </script>
  </head>
  <body>
    <!-- Empty Layout-->
    <div class="topnav">
      <a class="active" href="/">Home</a>
      <a href="/page2">Page 2</a>
    </div>
  <h1>Add a Passenger to the Manifest</h1>
  <form name="form" method="POST" action="/submit">
    <input type="text" id="customerName" name="name" placeholder="Customer Name">
    <input type="text" id="startLocation" name="startloc" placeholder="Start Location">
    <input type="text" id="endLocation" name="endloc" placeholder="End Location">
    <input type="submit" onclick="storeValues()" class="button" value="Add Passenger">
  </form><br>
  <div class="tooltip">hover over
    <span class="tooltiptext">This is the explanation</span>
  </div>
  <h1>Display The Manifest</h1>
  <button class="button" onclick="ajxGetRequest()">Display Manifest</button>
    <div id="testing"></div>
  <h1>Delete An Entry</h1>
  <form name="form" method="POST" action="/delete">
    <input type="number" name="numDelete" placeholder="0">
    <input type="submit" class="button" value="Delete Passenger">
  </form>
</body>
</html>